<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="format-detection" content="telephone=no, email=no, address=no">
<title>dbSheet — Excel業務を変え続けるための基盤 | 株式会社NEWCOM</title>
<meta name="description" content="dbSheetは、Excelの使いやすさを活かしながら、データの蓄積・共有・改善サイクルを実現する業務基盤です。脱Excelではなく、脱・固定業務へ。">
<meta name="keywords" content="dbSheet,Excel,業務改善,データベース,DX,脱Excel,NEWCOM">
<meta name="author" content="株式会社NEWCOM">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://www.newcom07.jp/dbsheet/lp/exhibition/">
<meta name="geo.region" content="JP">
<meta http-equiv="content-language" content="ja">
<meta property="og:type" content="website">
<meta property="og:title" content="dbSheet — Excel業務を変え続けるための基盤">
<meta property="og:description" content="Excelの自由さを活かしたまま、データの蓄積・共有・改善サイクルを実現。AI時代に最後まで残る思考のインターフェイス。">
<meta property="og:url" content="https://www.newcom07.jp/dbsheet/lp/exhibition/">
<meta property="og:site_name" content="dbSheet | 株式会社NEWCOM">
<meta property="og:locale" content="ja_JP">
<meta property="og:image" content="https://shiozaki-new.github.io/taikendemo/ogp.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="dbSheet — Excel業務を変え続けるための基盤">
<meta name="twitter:description" content="脱Excelではなく、脱・固定業務。Excelの使いやすさを活かしたデータ基盤。クリック体験デモ">
<meta name="theme-color" content="#0F2640">
<meta name="msapplication-TileColor" content="#0F2640">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SoftwareApplication","name":"dbSheet","applicationCategory":"BusinessApplication","operatingSystem":"Windows","description":"Excelの操作性を維持しながらデータベース連携を実現する業務基盤ソリューション。脱Excelではなく脱・固定業務を目指し、データの蓄積・共有・改善サイクルにより企業の変化耐性を構築する。","image":"https://shiozaki-new.github.io/taikendemo/ogp.png","offers":{"@type":"Offer","availability":"https://schema.org/InStock"},"provider":{"@type":"Organization","name":"株式会社NEWCOM","url":"https://www.newcom07.jp/","address":{"@type":"PostalAddress","addressCountry":"JP"}},"featureList":["Excel連携データベース","業務改善サイクル自動化","属人化解消","AI連携基盤","ガバナンス強化"]}
</script>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"dbSheetとは何ですか？","acceptedAnswer":{"@type":"Answer","text":"dbSheetは、Excelの操作性を維持しながらデータベース連携を実現する業務基盤ソリューションです。脱Excelではなく脱・固定業務を目指し、現場の思考プロセスを止めることなく、データの蓄積・共有・改善サイクルを実現します。"}},{"@type":"Question","name":"dbSheetを導入するとExcelの操作は変わりますか？","acceptedAnswer":{"@type":"Answer","text":"操作は変わりません。構造だけが変わります。現場担当者はこれまで通りExcelで思考・入力・試行錯誤を行いながら、裏側でデータベースと連携し、判断が経営資産として蓄積されるようになります。"}},{"@type":"Question","name":"dbSheetの導入効果は何ですか？","acceptedAnswer":{"@type":"Answer","text":"導入効果は3段階で現れます。第一に現場のExcel業務がDB接続で止まらなくなり、第二に現場と経営のデータが自然につながり、第三に企業全体が外部の変化に強い体質（変化耐性）を獲得します。"}}]}
</script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
--color-primary:#1B3A5C;--color-primary-light:#2A5A8C;--color-primary-dark:#0F2640;
--color-accent:#E8913A;--color-accent-light:#F5B870;
--color-bg-white:#FFFFFF;--color-bg-light:#F5F5F7;
--color-bg-frosted:rgba(255,255,255,0.72);--color-bg-frosted-dark:rgba(15,38,64,0.78);
--color-text-primary:#1D1D1F;--color-text-secondary:#6E6E73;--color-text-inverse:#FFFFFF;
--color-border:rgba(0,0,0,0.06);--color-border-light:rgba(255,255,255,0.12);
--color-before:#86868B;--color-after:#1B3A5C;
--color-success:#30A46C;--color-warning:#E5484D;--color-info:#3B82F6;
--font-primary:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI','Helvetica Neue','Noto Sans JP','Hiragino Kaku Gothic ProN','Hiragino Sans','Yu Gothic','Meiryo',sans-serif;
--font-mono:'SF Mono','JetBrains Mono','Source Code Pro','Menlo','Consolas',monospace;
--text-hero:clamp(28px,6vw,56px);--text-h1:clamp(24px,4.5vw,40px);--text-h2:clamp(20px,3.5vw,28px);
--text-body-lg:clamp(16px,2.5vw,22px);--text-body:clamp(15px,2vw,18px);--text-caption:clamp(12px,1.5vw,14px);
--space-xs:8px;--space-sm:12px;--space-md:24px;--space-lg:48px;--space-xl:80px;
--shadow-card:0 0.5px 0 rgba(0,0,0,0.05),0 4px 16px rgba(0,0,0,0.06),0 8px 32px rgba(0,0,0,0.04);
--shadow-elevated:0 0.5px 0 rgba(0,0,0,0.06),0 8px 24px rgba(0,0,0,0.08),0 20px 48px rgba(0,0,0,0.06);
--radius-card:16px;--radius-card-inner:12px;--radius-button:10px;--radius-pill:9999px;
--ease-spring:cubic-bezier(0.2,0.9,0.3,1.0);--ease-smooth:cubic-bezier(0.4,0.0,0.2,1.0);
--duration-fast:0.25s;--duration-normal:0.4s;--duration-slow:0.6s;
--content-padding:20px;--safe-top:env(safe-area-inset-top,0px);--safe-bottom:env(safe-area-inset-bottom,0px);
}
@media(min-width:768px){:root{--space-sm:16px;--space-md:32px;--space-lg:64px;--space-xl:100px;--content-padding:32px}}
@media(min-width:1024px){:root{--content-padding:40px}}
@media(min-width:1440px){:root{--text-hero:64px;--text-h1:48px;--text-h2:32px;--text-body-lg:24px;--text-body:20px;--text-caption:15px}}
@media(min-width:1920px){:root{--text-hero:76px;--text-h1:56px;--text-h2:38px;--text-body-lg:28px;--text-body:22px;--text-caption:16px;--space-xl:120px}}
html{scroll-behavior:smooth;-webkit-text-size-adjust:100%;text-size-adjust:100%}
body{font-family:var(--font-primary);font-size:var(--text-body);line-height:1.6;color:var(--color-text-primary);background:var(--color-bg-white);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;overflow-x:hidden;overscroll-behavior-y:none}
img,svg{display:block;max-width:100%}
a{color:inherit;text-decoration:none}
button{font:inherit;color:inherit;background:none;border:none;cursor:pointer}
ul,ol{list-style:none}
.sp-br{display:none}
@media(max-width:767px){.sp-br{display:initial}}
.skip-link{position:absolute;top:-100%;left:50%;transform:translateX(-50%);background:var(--color-accent);color:#fff;padding:var(--space-xs) var(--space-sm);border-radius:var(--radius-button);z-index:200;font-size:var(--text-caption)}
.skip-link:focus{top:var(--space-xs)}
:focus-visible{outline:2px solid var(--color-accent);outline-offset:3px;border-radius:var(--radius-button)}
:focus:not(:focus-visible){outline:none}

/* Header */
.header{position:fixed;top:0;left:0;right:0;height:56px;z-index:100;display:flex;align-items:center;justify-content:space-between;padding:0 var(--content-padding);background:rgba(15,38,64,0.92);transition:background var(--duration-fast)}
@supports(backdrop-filter:blur(1px)){.header{background:var(--color-bg-frosted-dark);backdrop-filter:blur(20px) saturate(180%);-webkit-backdrop-filter:blur(20px) saturate(180%);border-bottom:0.5px solid var(--color-border-light)}}
.header__logo{font-size:18px;font-weight:700;color:var(--color-text-inverse);letter-spacing:-0.02em;white-space:nowrap}
.header__logo span{color:var(--color-accent)}
.header__nav{display:none;gap:4px}
@media(min-width:1024px){.header__nav{display:flex}}
.header__nav a{font-size:12px;color:rgba(255,255,255,0.6);padding:6px 10px;border-radius:var(--radius-pill);transition:all var(--duration-fast);white-space:nowrap;font-weight:500}
.header__nav a:hover{background:rgba(255,255,255,0.08);color:rgba(255,255,255,0.9)}
.header__nav a.is-active{background:rgba(232,145,58,0.2);color:var(--color-accent)}

/* Sections */
.section{min-height:100svh;display:flex;align-items:center;justify-content:center;position:relative;padding:calc(56px + var(--space-lg)) var(--content-padding) var(--space-lg)}
@media(min-width:1024px){.section--fixed{height:100vh;min-height:auto}}
.section--dark{background:var(--color-primary-dark);color:var(--color-text-inverse)}
.section--dark::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 30% 40%,rgba(42,90,140,0.15) 0%,transparent 60%),radial-gradient(ellipse at 70% 80%,rgba(232,145,58,0.06) 0%,transparent 50%);pointer-events:none}
.section--light{background:var(--color-bg-light)}
.section--white{background:var(--color-bg-white)}
.section--no-snap{height:auto;min-height:auto;padding-top:calc(56px + var(--space-xl));padding-bottom:var(--space-xl)}
.section__inner{width:100%;max-width:960px;margin:0 auto;position:relative;z-index:1}
@media(min-width:1440px){.section__inner{max-width:1440px}}
@media(min-width:1920px){.section__inner{max-width:1700px}}
.section__heading{font-size:var(--text-h1);font-weight:600;text-align:center;margin-bottom:var(--space-lg);letter-spacing:-0.01em;line-height:1.2}
.section--dark .section__heading{color:rgba(255,255,255,0.85)}

/* Animations */
.anim{opacity:0;transform:translateY(20px);transition:opacity var(--duration-slow) var(--ease-smooth),transform var(--duration-slow) var(--ease-spring)}
.anim--blur{opacity:0;filter:blur(8px);transform:translateY(10px);transition:opacity var(--duration-slow) var(--ease-smooth),filter var(--duration-slow) var(--ease-smooth),transform var(--duration-slow) var(--ease-spring)}
.anim--up{opacity:0;transform:translateY(30px)}
.anim--left{opacity:0;transform:translateX(-30px)}
.anim--right{opacity:0;transform:translateX(30px)}
.anim--scale{opacity:0;transform:scale(0.92);transition:opacity var(--duration-slow) var(--ease-smooth),transform var(--duration-slow) var(--ease-spring)}
.anim--visible{opacity:1;transform:translateY(0) translateX(0) scale(1);filter:blur(0)}
@media(prefers-reduced-motion:reduce){*,*::before,*::after{animation-duration:0.01ms!important;animation-iteration-count:1!important;transition-duration:0.01ms!important;scroll-behavior:auto!important}.anim,.anim--blur,.anim--up,.anim--left,.anim--right,.anim--scale{opacity:1;transform:none;filter:none}}

/* S1: Hero */
.hero{text-align:center;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:60vh}
.hero__main{font-size:var(--text-hero);font-weight:700;line-height:1.15;color:var(--color-text-inverse);letter-spacing:-0.02em;max-width:1200px}
@media(min-width:1440px){.hero__main{max-width:1400px}}
@media(min-width:1920px){.hero__main{max-width:1700px}}
.hero__accent{color:var(--color-accent);text-shadow:0 0 40px rgba(232,145,58,0.25)}
.hero__sub{font-size:var(--text-body-lg);color:rgba(255,255,255,0.55);margin-top:var(--space-md);max-width:1100px;line-height:1.6}
@media(min-width:1920px){.hero__sub{max-width:1500px}}
.scroll-hint{position:absolute;bottom:var(--space-lg);left:50%;transform:translateX(-50%);display:flex;flex-direction:column;align-items:center;gap:4px;color:rgba(255,255,255,0.35)}
.scroll-hint__text{font-size:var(--text-caption);letter-spacing:0.1em}
.scroll-hint svg{width:20px;height:20px;stroke:currentColor;fill:none;animation:scrollPulse 2s ease-in-out infinite}
.scroll-hint svg:last-child{animation-delay:0.15s;opacity:0.5}
@keyframes scrollPulse{0%,100%{transform:translateY(0);opacity:0.5}50%{transform:translateY(4px);opacity:1}}

/* S2: Layer Cards */
.layer-cards{max-width:1100px;margin:0 auto;display:flex;flex-direction:column;gap:var(--space-sm)}
@media(min-width:1440px){.layer-cards{max-width:1300px;gap:var(--space-md)}}
@media(min-width:1920px){.layer-cards{max-width:1500px}}
.layer-card{background:var(--color-bg-white);border:0.5px solid var(--color-border);border-radius:var(--radius-card);box-shadow:var(--shadow-card);padding:16px 24px;display:flex;align-items:center;gap:var(--space-md);position:relative;overflow:hidden}
@media(min-width:1440px){.layer-card{padding:24px 40px}}
@media(min-width:1920px){.layer-card{padding:28px 48px}}
.layer-card::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;background:var(--color-border);border-radius:3px 0 0 3px;opacity:0.5}
.layer-card:last-child::before{background:var(--color-accent);opacity:0.8}
.layer-card__num{font-family:var(--font-mono);font-size:var(--text-caption);color:var(--color-accent);font-weight:700;flex-shrink:0}
.layer-card__title{font-size:var(--text-h2);font-weight:600;color:var(--color-text-primary)}
.layer-card__products{font-size:var(--text-body);color:var(--color-text-secondary);margin-top:4px}
.layer-card__features{font-size:var(--text-body);color:var(--color-text-secondary);margin-top:4px}

/* S3: Position */
.position{max-width:1100px;margin:0 auto;display:flex;flex-direction:column;align-items:center;gap:8px}
@media(min-width:1440px){.position{max-width:1300px}}
@media(min-width:1920px){.position{max-width:1500px}}
.position__card{opacity:0.5;padding:12px 32px;background:var(--color-bg-light);border:0.5px solid var(--color-border);border-radius:var(--radius-card);display:flex;align-items:center;gap:var(--space-sm)}
@media(min-width:1440px){.position__card{padding:16px 48px}}
.position__card-num{font-family:var(--font-mono);font-size:var(--text-caption);color:var(--color-text-secondary)}
.position__card-title{font-size:var(--text-body-lg);color:var(--color-text-secondary)}
.position__highlight{text-align:center;padding:var(--space-sm) 0;margin:4px 0}
.position__label{display:inline-block;background:rgba(232,145,58,0.08);color:var(--color-accent);font-size:var(--text-h2);font-weight:700;padding:10px 32px;border-radius:var(--radius-pill);border:1px solid rgba(232,145,58,0.15);box-shadow:0 0 20px rgba(232,145,58,0.08)}
@media(min-width:1440px){.position__label{padding:14px 48px}}
.position__arrows{color:var(--color-accent);display:flex;flex-direction:column;align-items:center;margin:4px auto}
.position__arrows svg{width:32px;height:32px;stroke:var(--color-accent);fill:none}
.position__message{text-align:center;font-size:var(--text-body-lg);color:var(--color-primary);font-weight:600;margin-top:var(--space-md);line-height:1.6;max-width:unset;width:100%;padding:var(--space-md) var(--space-md);border-radius:var(--radius-card);background:rgba(27,58,92,0.02)}
@media(min-width:1440px){.position__message{padding:var(--space-md) var(--space-lg)}}

/* S4: Declarations */
.declarations{text-align:center;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:var(--space-sm)}
.declarations__item{font-size:var(--text-body-lg);color:rgba(255,255,255,0.65);line-height:2.2;letter-spacing:0.01em}
.declarations__item:nth-child(3){font-size:calc(var(--text-body-lg) * 1.05);color:rgba(255,255,255,0.75)}
.declarations__item:nth-child(4){font-size:calc(var(--text-body-lg) * 1.12);color:rgba(255,255,255,0.88)}
.declarations__highlight{color:var(--color-accent);font-weight:700;text-shadow:0 0 30px rgba(232,145,58,0.2)}

/* S5: Competitors */
.competitors{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:repeat(2,1fr);gap:var(--space-sm)}
@media(min-width:768px){.competitors{gap:var(--space-md)}}
@media(min-width:1440px){.competitors{max-width:1300px}}
@media(min-width:1920px){.competitors{max-width:1500px}}
.competitor-card{background:var(--color-bg-white);border:0.5px solid var(--color-border);border-top:3px solid var(--color-before);border-radius:var(--radius-card);box-shadow:var(--shadow-card);padding:var(--space-md) var(--space-sm);text-align:center;display:flex;flex-direction:column;align-items:center;gap:var(--space-sm)}
@media(min-width:1440px){.competitor-card{padding:var(--space-lg) var(--space-md)}}
.competitor-card__icon{width:48px;height:48px;stroke:var(--color-before);fill:none}
@media(min-width:1440px){.competitor-card__icon{width:64px;height:64px}}
@media(min-width:1920px){.competitor-card__icon{width:72px;height:72px}}
.competitor-card__text{font-size:var(--text-body-lg);font-weight:600;color:var(--color-text-primary);line-height:1.4}
.competitors__message{grid-column:1/-1;text-align:center;font-size:var(--text-body-lg);color:var(--color-primary);font-weight:600;margin-top:var(--space-md);padding:var(--space-md) var(--space-md);border-radius:var(--radius-card);background:rgba(27,58,92,0.02)}
@media(min-width:1440px){.competitors__message{padding:var(--space-md) var(--space-lg)}}
.msg-accent{color:var(--color-accent);font-weight:700}

/* S6: Before/After */
.ba-container{max-width:1200px;margin:0 auto}
@media(min-width:1440px){.ba-container{max-width:1400px}}
@media(min-width:1920px){.ba-container{max-width:1700px}}
.ba-grid{display:flex;flex-direction:column;gap:var(--space-md);align-items:stretch}
@media(min-width:768px){.ba-grid{display:grid;grid-template-columns:1fr auto 1fr;gap:var(--space-md)}}
.ba-card{background:var(--color-bg-white);border:0.5px solid var(--color-border);border-radius:var(--radius-card);box-shadow:var(--shadow-card);overflow:hidden}
.ba-card--before{border-top:3px solid var(--color-before)}
.ba-card--after{border-left:3px solid var(--color-accent)}
.ba-card__header{padding:var(--space-sm) var(--space-md);font-size:var(--text-h2);font-weight:700}
.ba-card--before .ba-card__header{background:rgba(134,134,139,0.06);color:var(--color-before)}
.ba-card--after .ba-card__header{background:rgba(27,58,92,0.04);color:var(--color-after)}
.ba-card__sub{font-size:var(--text-caption);font-weight:400;opacity:0.6;margin-top:2px}
.ba-card__body{padding:var(--space-md)}
@media(min-width:1440px){.ba-card__body{padding:var(--space-md) var(--space-lg)}}
.ba-row{font-size:var(--text-body-lg);padding:var(--space-xs) 0;border-bottom:0.5px solid var(--color-border);font-weight:500}
.ba-row:last-child{border-bottom:none}
.ba-arrows{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:var(--space-sm);padding:var(--space-sm) 0}
@media(min-width:768px){.ba-arrows{padding:0 var(--space-sm)}}
.ba-arrows svg{width:32px;height:32px;stroke:var(--color-accent);fill:none}
@media(max-width:767px){.ba-arrows{flex-direction:row}.ba-arrows svg{transform:rotate(90deg)}}
.ba-message{text-align:center;margin-top:var(--space-lg)}
.ba-message__main{font-size:var(--text-h2);font-weight:700;color:var(--color-primary);line-height:1.4}
.ba-message__sub{font-size:var(--text-body);color:var(--color-text-secondary);margin-top:var(--space-xs)}

/* S6: Detail Diagram */
.fbd{max-width:1300px;margin:var(--space-xl) auto 0;width:100%}
@media(min-width:1920px){.fbd{max-width:1600px}}
.fbd__title{text-align:center;font-size:var(--text-h2);font-weight:600;color:var(--color-primary);margin-bottom:var(--space-lg)}
.fbd__grid{display:grid;grid-template-columns:1fr;gap:var(--space-md);margin-bottom:var(--space-lg)}
@media(min-width:768px){.fbd__grid{grid-template-columns:1fr 1fr}}
.fbd__card{border-radius:var(--radius-card);padding:var(--space-md)}
@media(min-width:1440px){.fbd__card{padding:var(--space-lg)}}
.fbd__card--problem{background:rgba(229,72,77,0.04);border:0.5px solid rgba(229,72,77,0.2)}
.fbd__card--solution{background:rgba(27,58,92,0.04);border:0.5px solid rgba(27,58,92,0.15)}
.fbd__card-header{display:flex;align-items:center;gap:10px;margin-bottom:var(--space-sm)}
.fbd__card-icon{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.fbd__card--problem .fbd__card-icon{background:rgba(229,72,77,0.1)}
.fbd__card--solution .fbd__card-icon{background:rgba(48,164,108,0.1)}
.fbd__card-icon svg{width:18px;height:18px;fill:none;stroke-width:2}
.fbd__card--problem .fbd__card-icon svg{stroke:var(--color-warning)}
.fbd__card--solution .fbd__card-icon svg{stroke:var(--color-success)}
.fbd__card-label{font-size:var(--text-body);font-weight:700}
.fbd__card--problem .fbd__card-label{color:var(--color-warning)}
.fbd__card--solution .fbd__card-label{color:var(--color-success)}
.fbd__list{display:flex;flex-direction:column;gap:10px}
.fbd__list-item{font-size:var(--text-body);color:var(--color-text-secondary);padding-left:16px;position:relative;line-height:1.5}
.fbd__list-item::before{content:'';position:absolute;left:0;top:8px;width:6px;height:6px;border-radius:50%}
.fbd__card--problem .fbd__list-item::before{background:rgba(229,72,77,0.3)}
.fbd__card--solution .fbd__list-item::before{background:rgba(48,164,108,0.3)}

/* S6: Cycle */
.cycle{max-width:1200px;margin:0 auto;background:var(--color-bg-white);border:0.5px solid var(--color-border);border-radius:var(--radius-card);box-shadow:var(--shadow-card);padding:var(--space-md)}
@media(min-width:1440px){.cycle{max-width:1400px;padding:var(--space-lg)}}
@media(min-width:1920px){.cycle{max-width:1600px}}
.cycle__label{text-align:center;font-size:var(--text-caption);font-weight:600;color:var(--color-text-secondary);margin-bottom:var(--space-md)}
.cycle__steps{display:flex;align-items:center;justify-content:center;flex-wrap:wrap;gap:var(--space-sm)}
@media(min-width:768px){.cycle__steps{flex-wrap:nowrap;gap:var(--space-md)}}
.cycle__step{display:flex;flex-direction:column;align-items:center;gap:8px;flex:0 0 auto;text-align:center}
.cycle__icon{width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center}
@media(min-width:1440px){.cycle__icon{width:56px;height:56px}}
.cycle__icon svg{width:22px;height:22px;fill:none;stroke-width:1.5}
.cycle__icon--excel{background:rgba(27,58,92,0.08)}.cycle__icon--excel svg{stroke:var(--color-primary)}
.cycle__icon--db{background:rgba(232,145,58,0.08)}.cycle__icon--db svg{stroke:var(--color-accent)}
.cycle__icon--bi{background:rgba(59,130,246,0.08)}.cycle__icon--bi svg{stroke:var(--color-info)}
.cycle__icon--loop{background:rgba(48,164,108,0.08)}.cycle__icon--loop svg{stroke:var(--color-success)}
.cycle__step-label{font-size:var(--text-caption);font-weight:600;color:var(--color-text-primary)}
.cycle__step-sub{font-size:11px;color:var(--color-text-secondary)}
@media(min-width:1440px){.cycle__step-sub{font-size:13px}}
.cycle__arrow{color:var(--color-text-secondary);font-size:18px;flex-shrink:0}
.cycle__note{text-align:center;margin-top:var(--space-md);font-size:var(--text-caption);color:var(--color-text-secondary)}
.cycle__note strong{color:var(--color-primary)}

/* S7: Risk List */
.heading-accent{color:var(--color-accent)}
.risk-list{max-width:900px;margin:0 auto;display:flex;flex-direction:column;gap:var(--space-sm);position:relative;padding-left:var(--space-md)}
@media(min-width:1440px){.risk-list{max-width:1100px}}
@media(min-width:1920px){.risk-list{max-width:1300px}}
.risk-list::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%;background:linear-gradient(to bottom,var(--color-accent),var(--color-warning));border-radius:4px 0 0 4px}
.risk-item{display:flex;align-items:center;gap:var(--space-sm);padding:var(--space-sm) var(--space-md);background:var(--color-bg-white);border:0.5px solid var(--color-border);border-radius:var(--radius-card);box-shadow:var(--shadow-card)}
@media(min-width:1440px){.risk-item{padding:var(--space-md) var(--space-lg)}}
.risk-item__num{font-family:var(--font-mono);font-size:var(--text-caption);color:var(--color-accent);font-weight:700;flex-shrink:0;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:50%;background:rgba(232,145,58,0.08)}
@media(min-width:1440px){.risk-item__num{width:44px;height:44px}}
.risk-item:nth-child(3) .risk-item__num,.risk-item:nth-child(4) .risk-item__num{background:rgba(229,72,77,0.08);color:var(--color-warning)}
.risk-item__text{font-size:var(--text-body-lg);font-weight:600;color:var(--color-text-primary)}

/* S8: Excel × AI */
.exai{max-width:1200px;margin:0 auto}
@media(min-width:1440px){.exai{max-width:1400px}}
@media(min-width:1920px){.exai{max-width:1600px}}
.exai__grid{display:flex;flex-direction:column;gap:var(--space-md);align-items:center}
@media(min-width:768px){.exai__grid{display:grid;grid-template-columns:1fr auto 1fr;gap:var(--space-md);align-items:stretch}}
.exai__card{background:var(--color-bg-white);border:0.5px solid var(--color-border);border-radius:var(--radius-card);box-shadow:var(--shadow-card);overflow:hidden;width:100%}
.exai__card-header{padding:var(--space-sm) var(--space-md);font-size:var(--text-body-lg);font-weight:700;text-align:center}
@media(min-width:1440px){.exai__card-header{padding:var(--space-md) var(--space-lg)}}
.exai__card--excel .exai__card-header{background:rgba(27,58,92,0.04);color:var(--color-primary);border-bottom:2px solid rgba(27,58,92,0.08)}
.exai__card--ai .exai__card-header{background:rgba(232,145,58,0.06);color:var(--color-accent);border-bottom:2px solid rgba(232,145,58,0.1)}
.exai__card-body{padding:var(--space-md);display:flex;flex-direction:column;gap:var(--space-sm)}
@media(min-width:1440px){.exai__card-body{padding:var(--space-md) var(--space-lg)}}
.exai__item{font-size:var(--text-body);color:var(--color-text-secondary);padding:var(--space-xs) 0;border-bottom:0.5px solid var(--color-border);text-align:center}
.exai__item:last-child{border-bottom:none}
.exai__center{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:var(--space-md) var(--space-sm)}
.exai__center-label{font-size:var(--text-h2);color:var(--color-accent);font-weight:700;text-shadow:0 0 20px rgba(232,145,58,0.2)}
.exai__center-line{width:2px;height:40px;background:linear-gradient(to bottom,transparent,var(--color-accent),transparent);margin:8px 0}
.exai__center-arrows svg{width:32px;height:32px;stroke:var(--color-accent);fill:none}
.exai__message{text-align:center;font-size:var(--text-body-lg);color:var(--color-primary);font-weight:600;margin-top:var(--space-lg);line-height:1.6}

/* S9: CTA */
.cta{text-align:center;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:60vh}
.cta__main{font-size:var(--text-hero);font-weight:700;color:var(--color-text-inverse);letter-spacing:-0.02em;line-height:1.2}
.cta__action{font-size:var(--text-h1);font-weight:700;color:var(--color-accent);margin-top:var(--space-md);text-shadow:0 0 40px rgba(232,145,58,0.3);position:relative;display:inline-block}
.cta__action::after{content:'';position:absolute;bottom:-4px;left:10%;right:10%;height:2px;background:linear-gradient(to right,transparent,var(--color-accent),transparent);opacity:0.4}
.cta__sub{font-size:var(--text-body-lg);color:rgba(255,255,255,0.55);margin-top:var(--space-sm)}
.cta__divider{width:100px;height:1px;background:linear-gradient(to right,transparent,rgba(255,255,255,0.2),transparent);margin:var(--space-lg) 0}
.cta__tagline{font-size:var(--text-body);color:rgba(255,255,255,0.7);font-weight:500}
.cta__company{font-size:var(--text-caption);color:rgba(255,255,255,0.4);margin-top:var(--space-xs);letter-spacing:0.1em}

/* S10: Demo */
.demo-section{padding-bottom:calc(var(--space-xl) + var(--safe-bottom))}
.demo__intro{text-align:center;font-size:var(--text-body);color:var(--color-text-secondary);display:flex;align-items:center;justify-content:center;gap:var(--space-xs);margin-bottom:var(--space-md)}
.demo__intro svg{width:20px;height:20px;stroke:var(--color-accent);fill:none;flex-shrink:0}
.demo-toggle{display:flex;justify-content:center;margin-bottom:var(--space-md)}
.demo-toggle__inner{display:inline-flex;background:var(--color-bg-light);border-radius:var(--radius-pill);padding:4px;gap:4px;border:0.5px solid var(--color-border)}
.demo-toggle__btn{padding:10px 28px;border-radius:var(--radius-pill);font-size:var(--text-caption);font-weight:600;color:var(--color-text-secondary);transition:all var(--duration-fast);touch-action:manipulation}
.demo-toggle__btn--active{background:var(--color-bg-white);color:var(--color-text-primary);box-shadow:var(--shadow-card)}
.demo-toggle__btn[data-mode="dbsheet"].demo-toggle__btn--active{background:var(--color-primary);color:var(--color-text-inverse)}
.demo-container{max-width:1200px;margin:0 auto;display:flex;flex-direction:column;gap:var(--space-md)}
@media(min-width:900px){.demo-container{flex-direction:row}}
@media(min-width:1440px){.demo-container{max-width:1400px}}
@media(min-width:1920px){.demo-container{max-width:1700px;min-height:600px}}

/* Demo Sheet */
.demo-sheet{flex:1;background:var(--color-bg-white);border:0.5px solid var(--color-border);border-radius:var(--radius-card);box-shadow:var(--shadow-card);overflow:hidden;min-width:0}
.demo-sheet__toolbar{display:flex;align-items:center;gap:var(--space-sm);padding:var(--space-xs) var(--space-sm);background:var(--color-bg-light);border-bottom:0.5px solid var(--color-border)}
.demo-sheet__dots{display:flex;gap:6px}
.demo-sheet__dot{width:12px;height:12px;border-radius:50%}
.demo-sheet__dot--r{background:#FF5F57}
.demo-sheet__dot--y{background:#FEBC2E}
.demo-sheet__dot--g{background:#28C840}
.demo-sheet__filename{font-size:var(--text-caption);color:var(--color-text-secondary);font-family:var(--font-mono)}
.demo-sheet__formula{display:flex;align-items:center;gap:8px;padding:6px var(--space-sm);border-bottom:0.5px solid var(--color-border);font-family:var(--font-mono);font-size:12px;color:var(--color-text-secondary);background:var(--color-bg-white)}
.demo-sheet__formula-ref{background:var(--color-bg-light);padding:2px 8px;border-radius:4px;font-weight:600;min-width:32px;text-align:center}
.demo-sheet__formula-val{flex:1;padding:2px 4px}
.demo-grid{width:100%;border-collapse:collapse;font-size:var(--text-caption);font-family:var(--font-mono)}
@media(min-width:1440px){.demo-grid{font-size:15px}}
.demo-grid th{padding:8px 10px;border:0.5px solid var(--color-border);background:var(--color-bg-light);font-weight:600;color:var(--color-text-secondary);text-align:center;font-size:11px}
.demo-grid td{padding:8px 10px;border:0.5px solid var(--color-border);text-align:center}
@media(min-width:1440px){.demo-grid th,.demo-grid td{padding:10px 14px}}
.demo-grid .row-num{background:var(--color-bg-light);color:var(--color-text-secondary);font-weight:500;width:36px}
.demo-grid .cell-name{text-align:left}
.demo-grid .cell-num{text-align:right;font-variant-numeric:tabular-nums}
.demo-grid .cell-header{font-weight:600;text-align:center;background:rgba(27,58,92,0.02)}
.demo-grid td[contenteditable]{cursor:text;transition:background 0.15s}
.demo-grid td[contenteditable]:focus{background:rgba(232,145,58,0.06);box-shadow:inset 0 0 0 2px var(--color-accent);outline:none}

/* Demo Panel */
.demo-panel{background:var(--color-bg-white);border:0.5px solid var(--color-border);border-radius:var(--radius-card);box-shadow:var(--shadow-card);overflow:hidden;display:flex;flex-direction:column}
@media(min-width:900px){.demo-panel{width:440px;flex-shrink:0}}
@media(min-width:1920px){.demo-panel{width:520px}}
.demo-panel__tabs{display:flex;background:var(--color-bg-light);border-bottom:0.5px solid var(--color-border)}
.demo-panel__tab{flex:1;padding:10px 8px;font-size:12px;font-weight:600;color:var(--color-text-secondary);text-align:center;border-bottom:2px solid transparent;transition:all var(--duration-fast);touch-action:manipulation}
.demo-panel__tab--active{color:var(--color-primary);border-bottom-color:var(--color-primary)}
.demo-panel__content{padding:var(--space-sm);flex:1;overflow-y:auto;max-height:460px;min-height:200px;font-size:var(--text-caption)}
@media(min-width:1920px){.demo-panel__content{max-height:560px;min-height:300px}}
.demo-panel__empty{color:var(--color-text-secondary);text-align:center;padding:var(--space-lg) var(--space-sm);opacity:0.6;font-size:13px;line-height:1.6}
.demo-panel__view{display:none}
.demo-panel__view--active{display:block}

/* Demo Layout Tuning: align edges, responsive spacing */
@media(min-width:900px){
  /* Switch to grid for equal-height columns and clearer gap */
  .demo-container{display:grid;grid-template-columns:minmax(0,1fr) clamp(320px,32vw,500px);gap:var(--space-lg);align-items:stretch}
  .demo-sheet{height:100%}
  .demo-panel{width:auto;height:100%}
  .demo-panel__content{max-height:none;height:100%}
}
@media(min-width:1440px){
  .demo-container{grid-template-columns:minmax(0,1fr) clamp(360px,28vw,520px)}
}

/* Demo Logs */
.demo__log-item{padding:8px 10px;border-radius:var(--radius-card-inner);margin-bottom:6px;font-size:12px;line-height:1.5;animation:logSlide 0.4s var(--ease-spring)}
.demo__log-item--warn{background:rgba(229,72,77,0.06);border-left:3px solid var(--color-warning)}
.demo__log-item--ok{background:rgba(48,164,108,0.06);border-left:3px solid var(--color-success)}
.demo__log-tag{display:inline-block;font-size:10px;font-weight:700;padding:1px 6px;border-radius:4px;margin-right:4px}
.demo__log-tag--warn{background:rgba(229,72,77,0.12);color:var(--color-warning)}
.demo__log-tag--ok{background:rgba(48,164,108,0.12);color:var(--color-success)}
.demo__log-time{font-family:var(--font-mono);font-size:10px;color:var(--color-text-secondary);opacity:0.6}
@keyframes logSlide{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}
@keyframes flashOk{0%{background:rgba(48,164,108,0.25)}100%{background:transparent}}
@keyframes flashWarn{0%{background:rgba(229,72,77,0.2)}100%{background:transparent}}
.flash-ok{animation:flashOk 0.6s ease-out}
.flash-warn{animation:flashWarn 0.6s ease-out}

/* Demo SQL */
.demo__sql{background:var(--color-primary-dark);border-radius:var(--radius-card-inner);padding:10px 12px;margin-bottom:8px;font-family:var(--font-mono);font-size:11px;line-height:1.6;overflow-x:auto;animation:logSlide 0.4s var(--ease-spring)}
.demo__sql .kw{color:#7CB7FF}.demo__sql .val{color:#F5B870}.demo__sql .cm{color:rgba(255,255,255,0.35)}
.demo__sql .ok{display:inline-block;padding:2px 6px;background:rgba(48,164,108,0.15);color:var(--color-success);border-radius:4px;margin-top:4px;font-size:10px}
.sql-kw{color:#7CB7FF}.sql-val{color:#F5B870}
.sql-ok{display:inline-block;background:rgba(48,164,108,0.15);color:var(--color-success);padding:2px 6px;border-radius:4px;margin-top:4px}

/* Demo DB Table */
.demo__db{margin:8px 0;border:0.5px solid var(--color-border);border-radius:var(--radius-card-inner);overflow:hidden;animation:logSlide 0.4s var(--ease-spring)}
.demo__db table{width:100%;border-collapse:collapse;font-size:11px;font-family:var(--font-mono)}
.demo__db th{padding:5px 8px;background:var(--color-primary);color:#fff;font-weight:600;text-align:center;font-size:10px}
.demo__db td{padding:4px 8px;border-bottom:0.5px solid var(--color-border);text-align:center;font-size:11px}
.demo__db-row--flash{animation:flashOk 0.8s var(--ease-smooth)}

/* Demo BI */
.demo__bi-kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:var(--space-sm)}
.demo__bi-kpi{background:var(--color-bg-light);border-radius:var(--radius-card-inner);padding:10px;text-align:center}
.demo__bi-kpi-label{font-size:10px;color:var(--color-text-secondary);font-weight:600;text-transform:uppercase;letter-spacing:0.05em}
.demo__bi-kpi-value{font-size:18px;font-weight:700;font-family:var(--font-mono);color:var(--color-primary);margin-top:2px}
@media(min-width:1440px){.demo__bi-kpi-value{font-size:20px}}
.demo__bi-delta{font-size:11px;font-weight:600;margin-top:2px}
.demo__bi-delta--up{color:var(--color-success)}
.demo__bi-delta--down{color:var(--color-warning)}
.demo__bi-kpi-delta{font-size:11px;font-family:var(--font-mono);margin-top:3px;font-weight:600}
.delta-up{color:var(--color-success)}
.delta-down{color:var(--color-warning)}
.demo__bi-chart{display:flex;align-items:flex-end;justify-content:space-around;height:120px;padding:8px;background:var(--color-bg-light);border-radius:var(--radius-card-inner)}
@media(min-width:1440px){.demo__bi-chart{height:140px}}
.demo__bi-bar-wrap{display:flex;flex-direction:column;align-items:center;flex:1;height:100%}
.demo__bi-bar{width:100%;border-radius:4px 4px 0 0;background:var(--color-primary);transition:height 0.5s var(--ease-spring),background 0.3s;margin-top:auto;min-height:4px}
.demo__bi-bar--changed{background:var(--color-accent)}
.demo__bi-bar-label{font-size:9px;font-family:var(--font-mono);color:var(--color-text-secondary);white-space:nowrap;margin-top:4px;text-align:center}

/* Demo BI Update Message */
.demo__bi-msg{text-align:center;margin-top:var(--space-sm);font-size:12px;color:var(--color-success);font-weight:500}

/* Demo Knowledge */
.demo__kn-item{padding:10px;border-radius:var(--radius-card-inner);margin-bottom:8px;animation:logSlide 0.4s var(--ease-spring)}
.demo__kn-item--pattern{border-left:3px solid var(--color-info);background:rgba(59,130,246,0.04)}
.demo__kn-item--suggestion{border-left:3px solid var(--color-accent);background:rgba(232,145,58,0.04)}
.demo__kn-item--asset{border-left:3px solid var(--color-success);background:rgba(48,164,108,0.04)}
.demo__kn-header{display:flex;align-items:center;gap:6px;margin-bottom:4px}
.demo__kn-badge{font-size:10px;font-weight:700;padding:2px 8px;border-radius:4px}
.demo__kn-badge--pattern{background:rgba(59,130,246,0.1);color:var(--color-info)}
.demo__kn-badge--suggestion{background:rgba(232,145,58,0.1);color:var(--color-accent)}
.demo__kn-badge--asset{background:rgba(48,164,108,0.1);color:var(--color-success)}
.demo__kn-title{font-size:12px;font-weight:600;color:var(--color-text-primary)}
.demo__kn-desc{font-size:11px;color:var(--color-text-secondary);line-height:1.5}
.demo__kn-counter{text-align:center;font-size:12px;color:var(--color-text-secondary);padding:8px;font-weight:500}

/* Demo Result */
/* 幅をS5の .competitors__message と揃える: 親幅→1300→1500 */
.demo__result{width:100%;max-width:100%;margin:var(--space-md) auto 0;padding:var(--space-md);border-radius:var(--radius-card);text-align:center;animation:logSlide 0.4s var(--ease-spring)}
@media(min-width:1440px){.demo__result{max-width:1300px;padding:var(--space-md) var(--space-lg)}}
@media(min-width:1920px){.demo__result{max-width:1500px}}
.demo__result--warn{background:rgba(229,72,77,0.04);border:0.5px solid rgba(229,72,77,0.12)}
.demo__result--ok{background:rgba(27,58,92,0.03);border:0.5px solid rgba(27,58,92,0.1)}
.demo__result-main{font-size:var(--text-body-lg);font-weight:700}
.demo__result--warn .demo__result-main{color:var(--color-warning)}
.demo__result--ok .demo__result-main{color:var(--color-primary)}
.demo__result-sub{font-size:var(--text-body);color:var(--color-text-secondary);margin-top:4px}
.demo__guide{text-align:center;font-size:var(--text-caption);color:var(--color-text-secondary);margin-top:var(--space-lg);opacity:0.7}
</style>
</head>
<body>
<a href="#main-content" class="skip-link">本文へスキップ</a>

<header class="header" role="banner">
  <div class="header__logo">d<span>b</span>Sheet</div>
  <nav class="header__nav" aria-label="セクションナビゲーション">
    <a href="#section-1-nin" data-nav="1">課題認識</a>
    <a href="#section-2-market" data-nav="2">市場構造</a>
    <a href="#section-3-position" data-nav="3">立ち位置</a>
    <a href="#section-4-non-substitution" data-nav="4">宣言</a>
    <a href="#section-5-true-competitor" data-nav="5">競合</a>
    <a href="#section-6-core-value" data-nav="6">核心価値</a>
    <a href="#section-7-management-risk" data-nav="7">リスク</a>
    <a href="#section-8-excel-ai" data-nav="8">Excel×AI</a>
    <a href="#section-9-final-message" data-nav="9">CTA</a>
    <a href="#section-10-taiken" data-nav="10">体験</a>
  </nav>
</header>

<main id="main-content">

<!-- S1: 認（課題認識） -->
<section id="section-1-nin" class="section section--dark section--fixed" aria-labelledby="heading-1">
  <div class="section__inner hero">
    <h1 id="heading-1" class="hero__main anim anim--blur" data-delay="200">Excel、まだ<span class="hero__accent">"捨てる側"</span>だと<br class="sp-br">思っていませんか？</h1>
    <p class="hero__sub anim anim--up" data-delay="700">AI時代に最初に捨てるべきものではなく、<br class="sp-br">最後まで残る"思考のインターフェイス"</p>
  </div>
  <div class="scroll-hint anim" data-delay="1400">
    <span class="scroll-hint__text">Scroll</span>
    <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
    <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
  </div>
</section>

<!-- S2: 思（市場構造） -->
<section id="section-2-market" class="section section--light section--fixed" aria-labelledby="heading-2">
  <div class="section__inner">
    <h2 id="heading-2" class="section__heading anim">業界構造の三層</h2>
    <div class="layer-cards">
      <div class="layer-card anim anim--up" data-delay="300">
        <div class="layer-card__num">①</div>
        <div class="layer-card__body">
          <div class="layer-card__title">ERP・基幹層</div>
          <div class="layer-card__products">SAP / Oracle / フルスクラッチ基幹</div>
          <div class="layer-card__features">高額・重い・全体最適志向・変更コスト高</div>
        </div>
      </div>
      <div class="layer-card anim anim--up" data-delay="500">
        <div class="layer-card__num">②</div>
        <div class="layer-card__body">
          <div class="layer-card__title">SaaS特化層</div>
          <div class="layer-card__products">Salesforce / kintone / 業務特化クラウド</div>
          <div class="layer-card__features">速い・パッケージ前提・業務を型に合わせる</div>
        </div>
      </div>
      <div class="layer-card anim anim--up" data-delay="700">
        <div class="layer-card__num">③</div>
        <div class="layer-card__body">
          <div class="layer-card__title">現場Excel層</div>
          <div class="layer-card__products">Excel / Access / 個人管理ファイル</div>
          <div class="layer-card__features">柔軟・速い・属人化・組織に残らない</div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- S3: 思（立ち位置） -->
<section id="section-3-position" class="section section--white section--fixed" aria-labelledby="heading-3">
  <div class="section__inner">
    <h2 id="heading-3" class="section__heading anim">dbSheetの立ち位置</h2>
    <div class="position">
      <div class="position__card anim" data-delay="300"><span class="position__card-num">①</span><span class="position__card-title">ERP・基幹層</span></div>
      <div class="position__card anim" data-delay="400"><span class="position__card-num">②</span><span class="position__card-title">SaaS特化層</span></div>
      <div class="position__highlight anim anim--scale" data-delay="600">
        <div class="position__arrows"><svg viewBox="0 0 32 32" fill="none" stroke-width="2"><path d="M16 4v24M10 8l6-4 6 4M10 24l6 4 6-4"/></svg></div>
        <span class="position__label">dbSheetが接続する領域</span>
        <div class="position__arrows"><svg viewBox="0 0 32 32" fill="none" stroke-width="2"><path d="M16 4v24M10 8l6-4 6 4M10 24l6 4 6-4"/></svg></div>
      </div>
      <div class="position__card anim" data-delay="500"><span class="position__card-num">③</span><span class="position__card-title">現場Excel層</span></div>
      <p class="position__message anim" data-delay="1100">Excelの柔軟性を残す。属人化を止める。<br class="sp-br">SaaSのように固定しない。ERPほど重くしない。</p>
    </div>
  </div>
</section>

<!-- S4: 鳴（非代替宣言） -->
<section id="section-4-non-substitution" class="section section--dark section--fixed" aria-labelledby="heading-4">
  <div class="section__inner declarations">
    <h2 id="heading-4" class="section__heading anim" data-delay="0">競争しない宣言</h2>
    <div class="declarations__item anim anim--left" data-delay="400">dbSheetは、SAPの<span class="declarations__highlight">代替ではない</span></div>
    <div class="declarations__item anim anim--left" data-delay="700">dbSheetは、Salesforceの<span class="declarations__highlight">代替ではない</span></div>
    <div class="declarations__item anim anim--left" data-delay="1000">dbSheetは、kintoneの<span class="declarations__highlight">代替ではない</span></div>
  </div>
</section>

<!-- S5: 鳴（本当の競合） -->
<section id="section-5-true-competitor" class="section section--white section--fixed" aria-labelledby="heading-5">
  <div class="section__inner">
    <h2 id="heading-5" class="section__heading anim">本当の競合</h2>
    <div class="competitors">
      <div class="competitor-card anim anim--up" data-delay="300">
        <svg class="competitor-card__icon" viewBox="0 0 40 40" stroke-width="1.5"><rect x="6" y="6" width="28" height="28" rx="3" fill="none"/><path d="M6 14h28M14 14v20"/><path d="M20 22h8M20 28h5" opacity="0.5"/></svg>
        <div class="competitor-card__text">放置されたExcel</div>
      </div>
      <div class="competitor-card anim anim--up" data-delay="500">
        <svg class="competitor-card__icon" viewBox="0 0 40 40" stroke-width="1.5" fill="none"><circle cx="14" cy="20" r="8"/><circle cx="26" cy="20" r="8"/><path d="M20 15v10" opacity="0.5"/></svg>
        <div class="competitor-card__text">部署ごとの分断</div>
      </div>
      <div class="competitor-card anim anim--up" data-delay="700">
        <svg class="competitor-card__icon" viewBox="0 0 40 40" stroke-width="1.5" fill="none"><rect x="8" y="8" width="24" height="24" rx="3"/><path d="M14 16h12M14 22h12M14 28h8"/><path d="M32 8l-6 6" stroke-width="2"/></svg>
        <div class="competitor-card__text">変えられない業務</div>
      </div>
      <div class="competitor-card anim anim--up" data-delay="900">
        <svg class="competitor-card__icon" viewBox="0 0 40 40" stroke-width="1.5" fill="none"><circle cx="20" cy="16" r="6"/><path d="M10 34c0-6 4-10 10-10s10 4 10 10"/><path d="M28 12l4-4M30 16h4" opacity="0.5"/></svg>
        <div class="competitor-card__text">AIを活かせない状態</div>
      </div>
      <div class="competitors__message anim" data-delay="1200">本当の競合は、製品ではなく<span class="msg-accent">"状態"</span>である</div>
    </div>
  </div>
</section>

<!-- S6: 鳴（核心価値） -->
<section id="section-6-core-value" class="section section--light section--no-snap" aria-labelledby="heading-6">
  <div class="section__inner">
    <h2 id="heading-6" class="section__heading anim">"脱Excel"ではなく<span style="color:var(--color-primary)">"脱・固定業務"</span></h2>
    <div class="ba-container">
      <div class="ba-grid">
        <div class="ba-card ba-card--before anim anim--left" data-delay="300">
          <div class="ba-card__header">Before<div class="ba-card__sub">従来の認識</div></div>
          <div class="ba-card__body">
            <div class="ba-row">脱Excel</div>
            <div class="ba-row">IT刷新</div>
            <div class="ba-row">ツール導入</div>
          </div>
        </div>
        <div class="ba-arrows anim anim--scale" data-delay="700">
          <svg viewBox="0 0 32 32" fill="none" stroke-width="2"><path d="M4 16h24M22 10l6 6-6 6"/></svg>
          <svg viewBox="0 0 32 32" fill="none" stroke-width="2"><path d="M4 16h24M22 10l6 6-6 6"/></svg>
          <svg viewBox="0 0 32 32" fill="none" stroke-width="2"><path d="M4 16h24M22 10l6 6-6 6"/></svg>
        </div>
        <div class="ba-card ba-card--after anim anim--right" data-delay="500">
          <div class="ba-card__header">After<div class="ba-card__sub">dbSheetの価値</div></div>
          <div class="ba-card__body">
            <div class="ba-row">脱・固定業務</div>
            <div class="ba-row">変化耐性の獲得</div>
            <div class="ba-row">経営リスク低減</div>
          </div>
        </div>
      </div>
      <div class="ba-message">
        <p class="ba-message__main anim" data-delay="1400">操作は変わらない。構造だけが変わる。</p>
        <p class="ba-message__sub anim" data-delay="1500">Excelの自由さを活かしたまま、データの蓄積・共有・改善サイクルを実現</p>
      </div>
    </div>

    <!-- Detail Diagram -->
    <div class="fbd">
      <h3 class="fbd__title anim" data-delay="200">"脱・固定業務"とは何か — 構造で理解する</h3>
      <div class="fbd__grid">
        <div class="fbd__card fbd__card--problem anim anim--left" data-delay="400">
          <div class="fbd__card-header">
            <div class="fbd__card-icon"><svg viewBox="0 0 24 24"><path d="M12 9v4M12 17h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg></div>
            <div class="fbd__card-label">固定業務の問題</div>
          </div>
          <div class="fbd__list">
            <div class="fbd__list-item">現場の判断が個人PCの中で止まる</div>
            <div class="fbd__list-item">改善のたびに「誰かに聞く」が発生する</div>
            <div class="fbd__list-item">業務ルールが暗黙知のまま引き継がれる</div>
            <div class="fbd__list-item">AIを入れても「入力するだけ」で変化しない</div>
          </div>
        </div>
        <div class="fbd__card fbd__card--solution anim anim--right" data-delay="600">
          <div class="fbd__card-header">
            <div class="fbd__card-icon"><svg viewBox="0 0 24 24"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg></div>
            <div class="fbd__card-label">dbSheetで変わること</div>
          </div>
          <div class="fbd__list">
            <div class="fbd__list-item">Excelの操作はそのまま → DBに自動同期</div>
            <div class="fbd__list-item">改善が「構造」として組織に残る</div>
            <div class="fbd__list-item">暗黙知がデータとして蓄積・共有される</div>
            <div class="fbd__list-item">AIが整ったデータを使って成果を出せる</div>
          </div>
        </div>
      </div>

      <!-- Cycle -->
      <div class="cycle anim" data-delay="800">
        <div class="cycle__label">改善サイクルが"構造"に戻る</div>
        <div class="cycle__steps">
          <div class="cycle__step">
            <div class="cycle__icon cycle__icon--excel"><svg viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18M9 9v12"/></svg></div>
            <div class="cycle__step-label">Excel操作</div>
            <div class="cycle__step-sub">変わらない</div>
          </div>
          <div class="cycle__arrow">→</div>
          <div class="cycle__step">
            <div class="cycle__icon cycle__icon--db"><svg viewBox="0 0 24 24"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg></div>
            <div class="cycle__step-label">DB自動蓄積</div>
            <div class="cycle__step-sub">構造が変わる</div>
          </div>
          <div class="cycle__arrow">→</div>
          <div class="cycle__step">
            <div class="cycle__icon cycle__icon--bi"><svg viewBox="0 0 24 24"><path d="M18 20V10M12 20V4M6 20v-6"/></svg></div>
            <div class="cycle__step-label">経営判断に届く</div>
            <div class="cycle__step-sub">可視化・共有</div>
          </div>
          <div class="cycle__arrow">→</div>
          <div class="cycle__step">
            <div class="cycle__icon cycle__icon--loop"><svg viewBox="0 0 24 24"><path d="M17 1l4 4-4 4"/><path d="M3 11V9a4 4 0 014-4h14"/><path d="M7 23l-4-4 4-4"/><path d="M21 13v2a4 4 0 01-4 4H3"/></svg></div>
            <div class="cycle__step-label">改善が構造に戻る</div>
            <div class="cycle__step-sub">変化耐性の獲得</div>
          </div>
        </div>
        <div class="cycle__note">このサイクルが<strong>自動で</strong>回り続けることが"脱・固定業務"の実体</div>
      </div>
    </div>
  </div>
</section>

<!-- S7: 鳴（経営リスク） -->
<section id="section-7-management-risk" class="section section--white section--fixed" aria-labelledby="heading-7">
  <div class="section__inner">
    <h2 id="heading-7" class="section__heading anim">放置が生む<span class="heading-accent">経営リスク</span></h2>
    <div class="risk-list">
      <div class="risk-item anim anim--left" data-delay="300"><span class="risk-item__num">01</span><span class="risk-item__text">業務が変えられなくなるリスク</span></div>
      <div class="risk-item anim anim--left" data-delay="500"><span class="risk-item__num">02</span><span class="risk-item__text">現場判断が属人化するリスク</span></div>
      <div class="risk-item anim anim--left" data-delay="700"><span class="risk-item__num">03</span><span class="risk-item__text">改善が循環しないリスク</span></div>
      <div class="risk-item anim anim--left" data-delay="900"><span class="risk-item__num">04</span><span class="risk-item__text">AI導入が成果に繋がらないリスク</span></div>
    </div>
  </div>
</section>

<!-- S8: 示（Excel × AI） -->
<section id="section-8-excel-ai" class="section section--light section--fixed" aria-labelledby="heading-8">
  <div class="section__inner">
    <h2 id="heading-8" class="section__heading anim">ExcelとAIは競合しない</h2>
    <div class="exai">
      <div class="exai__grid">
        <div class="exai__card exai__card--excel anim anim--left" data-delay="300">
          <div class="exai__card-header">Excelが強い領域</div>
          <div class="exai__card-body">
            <div class="exai__item">仮説構築</div>
            <div class="exai__item">条件変更</div>
            <div class="exai__item">判断途中経過</div>
            <div class="exai__item">曖昧な業務設計</div>
          </div>
        </div>
        <div class="exai__center anim anim--scale" data-delay="700">
          <div class="exai__center-line"></div>
          <div class="exai__center-arrows"><svg viewBox="0 0 32 32" fill="none" stroke-width="2"><path d="M4 16h24M8 12l-4 4 4 4M24 12l4 4-4 4"/></svg></div>
          <div class="exai__center-label">dbSheet</div>
          <div class="exai__center-arrows"><svg viewBox="0 0 32 32" fill="none" stroke-width="2"><path d="M4 16h24M8 12l-4 4 4 4M24 12l4 4-4 4"/></svg></div>
          <div class="exai__center-line"></div>
        </div>
        <div class="exai__card exai__card--ai anim anim--right" data-delay="500">
          <div class="exai__card-header">AIが強い領域</div>
          <div class="exai__card-body">
            <div class="exai__item">パターン抽出</div>
            <div class="exai__item">大量処理</div>
            <div class="exai__item">要約</div>
            <div class="exai__item">抽象化</div>
          </div>
        </div>
      </div>
      <p class="exai__message anim" data-delay="1200">両者は競合ではない。役割が異なる。<br class="sp-br">dbSheetは両者を繋ぐ基盤である。</p>
    </div>
  </div>
</section>

<!-- S9: 示（CTA） -->
<section id="section-9-final-message" class="section section--dark section--fixed" aria-labelledby="heading-9">
  <div class="section__inner cta">
    <h2 id="heading-9" class="cta__main anim anim--blur" data-delay="200">百聞は一見にしかず。</h2>
    <p class="cta__action anim anim--scale" data-delay="500">今すぐ、デモで体感</p>
    <p class="cta__sub anim" data-delay="800">お近くのスタッフにお声がけください</p>
    <div class="cta__divider anim" data-delay="1100"></div>
    <p class="cta__tagline anim" data-delay="1100">dbSheet — 業務を変え続けるための基盤</p>
    <p class="cta__company anim" data-delay="1100">株式会社NEWCOM</p>
  </div>
</section>

<!-- S10: 応（クリックデモ体験）-->
<section id="section-10-taiken" class="section section--white section--no-snap demo-section" aria-labelledby="heading-10">
<div class="section__inner">
<h2 id="heading-10" class="section__heading anim">触れて、体感する。</h2>
<p class="demo__intro anim" data-delay="200"><svg viewBox="0 0 24 24" fill="none" stroke-width="2"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>セルの数値を変更して、モードを切り替えてみてください</p>
<div class="demo-toggle anim" data-delay="300">
<div class="demo-toggle__inner" role="radiogroup" aria-label="モード切替">
<button class="demo-toggle__btn demo-toggle__btn--active" data-mode="excel" role="radio" aria-checked="true" type="button">Excel 単体</button>
<button class="demo-toggle__btn" data-mode="dbsheet" role="radio" aria-checked="false" type="button">dbSheet 連携</button>
</div></div>
<div class="demo-container anim anim--scale" data-delay="400">
<div class="demo-sheet">
<div class="demo-sheet__toolbar"><div class="demo-sheet__dots"><span class="demo-sheet__dot demo-sheet__dot--r"></span><span class="demo-sheet__dot demo-sheet__dot--y"></span><span class="demo-sheet__dot demo-sheet__dot--g"></span></div><span class="demo-sheet__filename">売上管理表.xlsx</span></div>
<div class="demo-sheet__formula"><span class="demo-sheet__formula-ref" id="formulaRef">C2</span><span>fx</span><span class="demo-sheet__formula-val" id="formulaVal">120</span></div>
<div class="demo-sheet__grid">
<table class="demo-grid"><thead><tr><th></th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th></tr></thead>
<tbody>
<tr><td class="row-num">1</td><td class="cell-name" style="font-weight:600">担当者</td><td class="cell-name" style="font-weight:600">商品名</td><td class="cell-num" style="font-weight:600">数量</td><td class="cell-num" style="font-weight:600">単価</td><td class="cell-num" style="font-weight:600">合計</td></tr>
<tr data-row="2"><td class="row-num">2</td><td class="cell-name">田中</td><td class="cell-name">部品A</td><td class="cell-num" contenteditable="true" tabindex="0" data-col="qty" data-default="120">120</td><td class="cell-num" contenteditable="true" tabindex="0" data-col="price" data-default="2500">2,500</td><td class="cell-num cell-total">300,000</td></tr>
<tr data-row="3"><td class="row-num">3</td><td class="cell-name">佐藤</td><td class="cell-name">部品B</td><td class="cell-num" contenteditable="true" tabindex="0" data-col="qty" data-default="85">85</td><td class="cell-num" contenteditable="true" tabindex="0" data-col="price" data-default="4200">4,200</td><td class="cell-num cell-total">357,000</td></tr>
<tr data-row="4"><td class="row-num">4</td><td class="cell-name">鈴木</td><td class="cell-name">部品C</td><td class="cell-num" contenteditable="true" tabindex="0" data-col="qty" data-default="200">200</td><td class="cell-num" contenteditable="true" tabindex="0" data-col="price" data-default="1800">1,800</td><td class="cell-num cell-total">360,000</td></tr>
<tr data-row="5"><td class="row-num">5</td><td class="cell-name">高橋</td><td class="cell-name">部品D</td><td class="cell-num" contenteditable="true" tabindex="0" data-col="qty" data-default="50">50</td><td class="cell-num" contenteditable="true" tabindex="0" data-col="price" data-default="8900">8,900</td><td class="cell-num cell-total">445,000</td></tr>
<tr data-row="6"><td class="row-num">6</td><td class="cell-name">伊藤</td><td class="cell-name">部品E</td><td class="cell-num" contenteditable="true" tabindex="0" data-col="qty" data-default="300">300</td><td class="cell-num" contenteditable="true" tabindex="0" data-col="price" data-default="950">950</td><td class="cell-num cell-total">285,000</td></tr>
</tbody></table>
</div></div>
<div class="demo-panel">
<div class="demo-panel__tabs" id="panelTabs" style="display:none"></div>
<div class="demo-panel__content" id="panelContent"><div class="demo-panel__empty">イベントログ<br><br>セルを編集すると、ここにログが表示されます</div></div>
</div></div>
<div class="demo__result" id="demoResult" style="display:none"></div>
<p class="demo__guide anim" data-delay="700">※ 体験後、お気軽にスタッフへお声がけください</p>
</div>
</section>

</main>

<script>
(function(){
'use strict';

/* ========== State ========== */
var initialData = {
  2:{name:'田中',product:'部品A',qty:120,price:2500},
  3:{name:'佐藤',product:'部品B',qty:85,price:4200},
  4:{name:'鈴木',product:'部品C',qty:200,price:1800},
  5:{name:'高橋',product:'部品D',qty:50,price:8900},
  6:{name:'伊藤',product:'部品E',qty:300,price:950}
};
var currentData = JSON.parse(JSON.stringify(initialData));
var mode = 'excel';
var editCount = 0;
var totalEdits = 0;
var knowledgeItems = [];
var prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

/* ========== Utilities ========== */
function fmt(n){return n.toLocaleString('ja-JP')}
function fmtYen(n){
  if(n>=1000000) return '¥'+(n/1000000).toFixed(1)+'M';
  if(n>=1000) return '¥'+Math.round(n/1000)+'K';
  return '¥'+n;
}
function getTime(){var d=new Date();return [d.getHours(),d.getMinutes(),d.getSeconds()].map(function(v){return ('0'+v).slice(-2)}).join(':')}

/* ========== Intersection Observer (Animations) ========== */
var io = new IntersectionObserver(function(entries){
  entries.forEach(function(e){
    if(e.isIntersecting){
      var el = e.target;
      var delay = parseInt(el.getAttribute('data-delay'))||0;
      if(prefersReducedMotion) delay=0;
      setTimeout(function(){el.classList.add('anim--visible')},delay);
      io.unobserve(el);
    }
  });
},{threshold:0.1,rootMargin:'0px 0px -40px 0px'});
document.querySelectorAll('.anim').forEach(function(el){io.observe(el)});

/* ========== Navigation ========== */
var sections = document.querySelectorAll('.section');
var navLinks = document.querySelectorAll('.header__nav a');
var navIO = new IntersectionObserver(function(entries){
  entries.forEach(function(e){
    if(e.isIntersecting){
      var id = e.target.id;
      navLinks.forEach(function(a){
        a.classList.toggle('is-active', a.getAttribute('href')==='#'+id);
      });
    }
  });
},{threshold:0.3});
sections.forEach(function(s){navIO.observe(s)});

/* Keyboard shortcuts */
document.addEventListener('keydown',function(e){
  var target=e.target;
  if((target&&target.isContentEditable)||(target&&target.closest&&target.closest('input, textarea, select, [contenteditable="true"]'))) return;
  var key = parseInt(e.key);
  if(key>=0 && key<=9 && !e.ctrlKey && !e.metaKey && !e.altKey){
    e.preventDefault();
    var idx = key===0?10:key;
    var sec = sections[idx-1];
    if(sec) sec.scrollIntoView({behavior:'smooth'});
  }
});

/* Toggle */
var toggleBtns=document.querySelectorAll('.demo-toggle__btn');
toggleBtns.forEach(function(btn){
btn.addEventListener('click',function(){
var newMode=btn.getAttribute('data-mode');
if(newMode===mode) return;
mode=newMode;
editCount=0;
toggleBtns.forEach(function(b){
b.classList.remove('demo-toggle__btn--active');
b.setAttribute('aria-checked','false');
});
btn.classList.add('demo-toggle__btn--active');
btn.setAttribute('aria-checked','true');
document.getElementById('demoResult').style.display='none';
setupPanel();
});
});

function setupPanel(){
var tabs=document.getElementById('panelTabs');
var content=document.getElementById('panelContent');
if(mode==='excel'){
tabs.style.display='none';
content.innerHTML='<div class="demo-panel__empty">イベントログ<br><br>セルを編集すると、ここにログが表示されます</div>';
} else {
tabs.style.display='flex';
tabs.innerHTML='<button class="demo-panel__tab demo-panel__tab--active" data-tab="sql" type="button">DB同期</button><button class="demo-panel__tab" data-tab="bi" type="button">経営判断</button><button class="demo-panel__tab" data-tab="knowledge" type="button">ノウハウ蓄積</button>';
content.innerHTML='<div class="demo-panel__empty">SQLリアルタイム同期<br><br>セルを編集すると、SQLクエリがリアルタイムで表示されます</div>';
var tabBtns=tabs.querySelectorAll('.demo-panel__tab');
tabBtns.forEach(function(tb){
tb.addEventListener('click',function(){
tabBtns.forEach(function(t){t.classList.remove('demo-panel__tab--active')});
tb.classList.add('demo-panel__tab--active');
showTabContent(tb.getAttribute('data-tab'));
});
});
}
}

var sqlLogs=[];
var dbTableShown=false;

function showTabContent(tab){
var content=document.getElementById('panelContent');
if(tab==='sql'){
content.innerHTML='';
if(sqlLogs.length===0){
content.innerHTML='<div class="demo-panel__empty">SQLリアルタイム同期<br><br>セルを編集すると、SQLクエリがリアルタイムで表示されます</div>';
} else {
sqlLogs.forEach(function(h){content.insertAdjacentHTML('beforeend',h)});
if(dbTableShown) content.insertAdjacentHTML('beforeend',buildDBTable());
}
content.scrollTop=content.scrollHeight;
} else if(tab==='bi'){
content.innerHTML=buildBI();
} else if(tab==='knowledge'){
content.innerHTML='';
if(knowledgeItems.length===0){
content.innerHTML='<div class="demo-panel__empty">ノウハウ蓄積・改善サイクル<br><br>編集操作が蓄積されると、パターンと改善提案が自動生成されます</div>';
} else {
knowledgeItems.forEach(function(h){content.insertAdjacentHTML('beforeend',h)});
content.insertAdjacentHTML('beforeend','<div class="demo__kn-counter" style="display:block">蓄積ノウハウ: '+knowledgeItems.length+' 件</div>');
}
}
}

function buildDBTable(){
var h='<div class="demo__db"><table><thead><tr><th style="width:60px">ID</th><th>担当者</th><th style="width:80px">数量</th><th style="width:80px">単価</th><th style="width:100px">合計</th></tr></thead><tbody>';
for(var r=2;r<=6;r++){
var d=currentData[r];
h+='<tr id="dbrow-'+r+'"><td>'+(r-1)+'</td><td>'+d.name+'</td><td>'+fmt(d.qty)+'</td><td>'+fmt(d.price)+'</td><td>'+fmt(d.qty*d.price)+'</td></tr>';
}
h+='</tbody></table></div>';
return h;
}

function buildBI(){
var totalSales=0,totalPrice=0,maxSales=0;
var salesByPerson={};
for(var r=2;r<=6;r++){
var d=currentData[r];
var s=d.qty*d.price;
totalSales+=s;
totalPrice+=d.price;
salesByPerson[r]={name:d.name,sales:s,changed:d.qty!==initialData[r].qty||d.price!==initialData[r].price};
if(s>maxSales) maxSales=s;
}
var initTotal=0;for(var r2=2;r2<=6;r2++){var id2=initialData[r2];initTotal+=id2.qty*id2.price}
var delta=totalSales-initTotal;
var deltaStr=delta>=0?'+'+fmtYen(delta):'-'+fmtYen(Math.abs(delta));
var deltaClass=delta>=0?'delta-up':'delta-down';
var h='<div class="demo__bi">';
h+='<div class="demo__bi-kpis">';
h+='<div class="demo__bi-kpi"><div class="demo__bi-kpi-label">総売上</div><div class="demo__bi-kpi-value">'+fmtYen(totalSales)+'</div>'+(delta!==0?'<div class="demo__bi-kpi-delta '+deltaClass+'">'+deltaStr+'</div>':'')+'</div>';
h+='<div class="demo__bi-kpi"><div class="demo__bi-kpi-label">平均単価</div><div class="demo__bi-kpi-value">'+fmtYen(Math.round(totalPrice/5))+'</div></div>';
h+='<div class="demo__bi-kpi"><div class="demo__bi-kpi-label">更新回数</div><div class="demo__bi-kpi-value">'+totalEdits+'</div></div>';
h+='</div>';
h+='<div class="demo__bi-chart">';
for(var r3=2;r3<=6;r3++){
var sp=salesByPerson[r3];
var pct=Math.max(4,Math.round((sp.sales/maxSales)*100));
h+='<div class="demo__bi-bar-wrap"><div class="demo__bi-bar'+(sp.changed?' demo__bi-bar--changed':'')+'" style="height:'+pct+'%"></div><div class="demo__bi-bar-label">'+sp.name+'</div></div>';
}
h+='</div>';
if(totalEdits>=2){h+='<div class="demo__bi-msg">✓ '+totalEdits+'回の変更がリアルタイムで経営指標に反映されています</div>'}
h+='</div>';
return h;
}

/* Cell Edit Handler */
var editableCells=document.querySelectorAll('td[contenteditable]');
editableCells.forEach(function(cell){
cell.addEventListener('focus',function(){
var row=cell.parentElement.getAttribute('data-row');
var col=cell.getAttribute('data-col');
var colLetter=col==='qty'?'C':'D';
document.getElementById('formulaRef').textContent=colLetter+row;
document.getElementById('formulaVal').textContent=cell.textContent.replace(/,/g,'');
try{var range=document.createRange();range.selectNodeContents(cell);var sel=window.getSelection();sel.removeAllRanges();sel.addRange(range)}catch(e){}
});
cell.addEventListener('keydown',function(e){
if(e.key==='Enter'){e.preventDefault();cell.blur()}
if(e.key==='Tab'){
e.preventDefault();
cell.blur();
var allEditable=Array.from(editableCells);
var idx=allEditable.indexOf(cell);
var next=e.shiftKey?idx-1:idx+1;
if(next>=0&&next<allEditable.length) allEditable[next].focus();
}
});
cell.addEventListener('blur',function(){
var row=parseInt(cell.parentElement.getAttribute('data-row'));
var col=cell.getAttribute('data-col');
var raw=cell.textContent.replace(/[,\s]/g,'');
var val=parseInt(raw,10);
if(isNaN(val)||val<0){val=parseInt(cell.getAttribute('data-default'),10)}
currentData[row][col]=val;
cell.textContent=col==='qty'?String(val):fmt(val);
var total=currentData[row].qty*currentData[row].price;
var totalCell=cell.parentElement.querySelector('.cell-total');
if(totalCell) totalCell.textContent=fmt(total);
document.getElementById('formulaVal').textContent=String(val);
editCount++;
totalEdits++;
if(mode==='excel') handleExcelEdit(row,col,val);
else handleDbsheetEdit(row,col,val);
});
});

function handleExcelEdit(row,col,val){
var cell=document.querySelector('tr[data-row="'+row+'"] td[data-col="'+col+'"]');
cell.classList.remove('flash-warn');
void cell.offsetWidth;
cell.classList.add('flash-warn');
var content=document.getElementById('panelContent');
if(editCount===1){content.innerHTML=''}
var name=currentData[row].name;
var logs=[
{text:'ファイル保存（個人PC）— '+name+'のデータ更新',tag:'個人ファイル'},
{text:'他の担当者は最新データを参照できません',tag:'属人化'},
{text:'変更履歴は記録されていません',tag:'履歴消失'}
];
logs.forEach(function(log,i){
setTimeout(function(){
var html='<div class="demo__log-item demo__log-item--warn"><div><span class="demo__log-time">['+getTime()+']</span><span class="demo__log-tag demo__log-tag--warn">'+log.tag+'</span></div><div class="demo__log-text">'+log.text+'</div></div>';
content.insertAdjacentHTML('beforeend',html);
content.scrollTop=content.scrollHeight;
},i*400);
});
if(editCount>=2) showResult('warn','操作は完了。しかしデータは個人に閉じたまま。','判断は会議で消え、改善は仕組みに戻らない');
}

function handleDbsheetEdit(row,col,val){
var cell=document.querySelector('tr[data-row="'+row+'"] td[data-col="'+col+'"]');
cell.classList.remove('flash-ok');
void cell.offsetWidth;
cell.classList.add('flash-ok');
var name=currentData[row].name;
var colName=col==='qty'?'quantity':'unit_price';
var total=currentData[row].qty*currentData[row].price;
var activeTab=document.querySelector('.demo-panel__tab--active');
var currentTab=activeTab?activeTab.getAttribute('data-tab'):'sql';
/* SQL log */
var sqlHtml='<div class="demo__sql"><span class="sql-kw">UPDATE</span> sales_data<br><span class="sql-kw">SET</span> '+colName+' = <span class="sql-val">'+val+'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;total = <span class="sql-val">'+total+'</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;updated_at = <span class="sql-kw">NOW</span>(),<br>&nbsp;&nbsp;&nbsp;&nbsp;updated_by = <span class="sql-val">\''+name+'\'</span><br><span class="sql-kw">WHERE</span> id = <span class="sql-val">'+(row-1)+'</span>;<br><br><span class="sql-ok">✓ 1 row affected — COMMIT</span></div>';
sqlLogs.push(sqlHtml);
setTimeout(function(){
var biSql='<div class="demo__sql"><span style="color:#6E6E73">-- BIダッシュボード自動更新トリガー</span><br><span class="sql-kw">NOTIFY</span> bi_dashboard, <span class="sql-val">\'sales_updated\'</span>;<br><span class="sql-ok">✓ 経営指標を再計算</span></div>';
sqlLogs.push(biSql);
if(currentTab==='sql') showTabContent('sql');
},600);
dbTableShown=true;
if(currentTab==='sql') showTabContent('sql');
/* Update BI */
setTimeout(function(){
if(document.querySelector('.demo-panel__tab--active')&&document.querySelector('.demo-panel__tab--active').getAttribute('data-tab')==='bi'){
showTabContent('bi');
}
},700);
/* Update Knowledge */
updateKnowledge(row,col,val);
/* DB row flash */
setTimeout(function(){
var dbRow=document.getElementById('dbrow-'+row);
if(dbRow){dbRow.classList.remove('demo__db-row--flash');void dbRow.offsetWidth;dbRow.classList.add('demo__db-row--flash')}
},100);
if(editCount===1) showResult('ok','同じExcel操作。しかし構造が違う。','DB同期 → 経営ダッシュボード更新 → ノウハウ蓄積 — すべて自動で発生');
if(editCount>=3) showResult('ok','データは蓄積され、判断は経営資産になり、改善が循環する。','これが「変化耐性」— 操作は変わらない。構造だけが変わる。');
}

function updateKnowledge(row,col,val){
var name=currentData[row].name;
var colLabel=col==='qty'?'数量':'単価';
var origVal=initialData[row][col];
var pctChange=origVal!==0?Math.round(((val-origVal)/origVal)*100):0;
var item;
if(totalEdits===1){item={type:'pattern',title:'変更パターン検出',desc:name+'の'+colLabel+'が変更されました（'+(pctChange>=0?'+':'')+pctChange+'%）。変更履歴をDBに自動記録。'}}
else if(totalEdits===2){item={type:'suggestion',title:'改善提案（自動生成）',desc:'複数回の数値変更を検出。類似パターンの過去データと照合し、最適値の候補を算出可能です。'}}
else if(totalEdits===3){item={type:'asset',title:'経営資産化',desc:'操作ログ '+totalEdits+'件が蓄積。担当者別の判断傾向を可視化し、組織の意思決定プロセスとして構造化されました。'}}
else if(totalEdits===4){item={type:'pattern',title:'トレンド分析',desc:'継続的な変更パターンからAIが需要予測モデルを更新。次回の発注推奨数量を自動算出します。'}}
else if(totalEdits%2===1){item={type:'suggestion',title:'改善サイクル反映',desc:'蓄積された判断データ（'+totalEdits+'件）から、業務プロセスの改善ポイントを3件検出。ルール化して全担当者に展開可能です。'}}
else{item={type:'asset',title:'ナレッジ自動更新',desc:'改善が構造に戻りました。次の担当者は、蓄積された '+totalEdits+' 件の判断履歴を参照して意思決定できます。'}}
var html='<div class="demo__kn-item demo__kn-item--'+item.type+'"><div class="demo__kn-header"><span class="demo__kn-badge demo__kn-badge--'+item.type+'">'+(item.type==='pattern'?'パターン':item.type==='suggestion'?'改善提案':'経営資産')+'</span><span class="demo__kn-title">'+item.title+'</span></div><div class="demo__kn-desc">'+item.desc+'</div></div>';
knowledgeItems.unshift(html);
var activeTab2=document.querySelector('.demo-panel__tab--active');
if(activeTab2&&activeTab2.getAttribute('data-tab')==='knowledge'){
showTabContent('knowledge');
}
}

function showResult(type,main,sub){
var el=document.getElementById('demoResult');
el.style.display='block';
el.className='demo__result demo__result--'+type;
el.innerHTML='<div class="demo__result-main">'+main+'</div><div class="demo__result-sub">'+sub+'</div>';
}

/* Scroll snap */
document.documentElement.style.scrollSnapType='y proximity';

})();
</script>
</body>
</html>
